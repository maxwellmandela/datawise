{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: How many times has the product 'kids baby cussions oil' been bought last week?", "completion": "SELECT COUNT(*) AS purchase_count FROM products p JOIN order_items oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id WHERE p.name = 'kids baby cussions oil' AND o.order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY);"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Show me the list of customers who bought 'Mens wallet' last week", "completion": "SELECT c.customer_id, c.customer_name FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE p.name = 'Mens wallet' AND o.order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY);"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: I want to see the customers whose emails have a charity.co.ke work emails", "completion": "SELECT * FROM customers WHERE email LIKE '%@charity.co.ke';"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: What is the total revenue from orders placed last month?", "completion": "SELECT SUM(p.price * oi.quantity) AS total_revenue FROM products p JOIN order_items oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id WHERE o.order_date >= DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m-01') AND o.order_date < DATE_FORMAT(CURDATE(), '%Y-%m-01');"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: How many distinct products were sold last week?", "completion": "SELECT COUNT(DISTINCT product_id) AS distinct_products_sold FROM order_items oi JOIN orders o ON oi.order_id = o.order_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY);"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Show me all orders placed in the last 30 days", "completion": "SELECT * FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Which customers bought more than 3 products in a single order?", "completion": "SELECT c.customer_name, o.order_id FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id GROUP BY c.customer_name, o.order_id HAVING COUNT(oi.product_id) > 3;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: List all products that have never been ordered", "completion": "SELECT p.name FROM products p LEFT JOIN order_items oi ON p.product_id = oi.product_id WHERE oi.order_id IS NULL;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Show me the average order value per customer", "completion": "SELECT c.customer_name, AVG(oi.quantity * p.price) AS average_order_value FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id GROUP BY c.customer_name;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Which products have been ordered more than 10 times?", "completion": "SELECT p.name, COUNT(*) AS order_count FROM products p JOIN order_items oi ON p.product_id = oi.product_id GROUP BY p.name HAVING order_count > 10;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: How many customers have placed an order?", "completion": "SELECT COUNT(DISTINCT customer_id) AS customer_count FROM orders;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: List all customers who have not placed an order", "completion": "SELECT c.customer_name FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id WHERE o.order_id IS NULL;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: What is the total quantity of 'Laptop' sold?", "completion": "SELECT SUM(oi.quantity) AS total_quantity FROM products p JOIN order_items oi ON p.product_id = oi.product_id WHERE p.name = 'Laptop';"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Show me the most popular product", "completion": "SELECT p.name, COUNT(*) AS purchase_count FROM products p JOIN order_items oi ON p.product_id = oi.product_id GROUP BY p.name ORDER BY purchase_count DESC LIMIT 1;"}
{"prompt": "Schema: {\n  \"tables\": {\n    \"customers\": {\n      \"columns\": [\n        \"customer_id\",\n        \"customer_name\",\n        \"email\"\n      ]\n    },\n    \"orders\": {\n      \"columns\": [\n        \"order_id\",\n        \"customer_id\",\n        \"order_date\"\n      ]\n    },\n    \"order_items\": {\n      \"columns\": [\n        \"order_item_id\",\n        \"order_id\",\n        \"product_id\",\n        \"quantity\"\n      ]\n    },\n    \"products\": {\n      \"columns\": [\n        \"product_id\",\n        \"name\",\n        \"price\"\n      ]\n    }\n  },\n  \"relationships\": {\n    \"customers_orders\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"customers\",\n      \"from_column\": \"customer_id\",\n      \"to_table\": \"orders\",\n      \"to_column\": \"customer_id\"\n    },\n    \"orders_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"orders\",\n      \"from_column\": \"order_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"order_id\"\n    },\n    \"products_order_items\": {\n      \"type\": \"one_to_many\",\n      \"from_table\": \"products\",\n      \"from_column\": \"product_id\",\n      \"to_table\": \"order_items\",\n      \"to_column\": \"product_id\"\n    }\n  }\n}\nQuery: Which customers placed orders worth more than $500?", "completion": "SELECT c.customer_name, SUM(oi.quantity * p.price) AS total_spent FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id GROUP BY c.customer_name HAVING total_spent > 500;"}
